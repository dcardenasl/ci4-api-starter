# Internationalization (i18n)

## Purpose
Define strict, reusable i18n rules for this template so new CRUD modules keep consistent language files and key usage.

## Language File Structure

```
app/Language/
├── en/
│   ├── Api.php
│   ├── Auth.php
│   ├── Email.php
│   ├── InputValidation.php
│   ├── Users.php
│   ├── ApiKeys.php
│   └── ...
└── es/
    └── (same files and same key tree)
```

## Naming Convention for New CRUD Modules
- Use `Plural PascalCase` for domain files.
- Example: `Products.php`, `Orders.php`, `Invoices.php`.
- Use keys like `Products.notFound`, `Orders.createdSuccess`.

## Key Usage Rules by Layer
- `Services`:
  - Use domain keys (`Products.*`, `Users.*`) for business messages.
  - Use `Api.*` only for transport-generic messages (`invalidRequest`, `validationFailed`, etc.).
- `Models`:
  - Validation messages must use `InputValidation.*` only.
- `Validation classes` (`app/Validations/*`):
  - Use `InputValidation.*` only.
- `Email templates/services`:
  - Use `Email.*` keys.

## Scope: What Must Be Localized
Must use `lang()`:
- API response messages.
- Exception messages returned to API clients.
- Validation messages.

Can stay technical/non-localized:
- Internal logs (`log_message`).
- Internal infra/config exceptions (non-user-facing).

## Locale Detection
Priority order:
1. `Accept-Language` header.
2. `defaultLocale` in `app/Config/App.php`.

## Guardrails (Required)
Run:

```bash
composer i18n-check
```

The check enforces:
- File parity between `en/` and `es/`.
- Key parity between both locales.
- All referenced `lang('File.key')` keys exist in both locales.
- Model validation messages use `InputValidation.*`.
- Basic detection of hardcoded user-facing exception messages.

## Mandatory Checklist for New CRUD Components
1. Create `app/Language/en/{ResourcePlural}.php`.
2. Create `app/Language/es/{ResourcePlural}.php` with the same keys.
3. Add validation keys in `InputValidation.php` (`en` and `es`).
4. Use domain keys in services and `InputValidation.*` in model validation messages.
5. Run `composer i18n-check` and tests before PR.
